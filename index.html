<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BRU WEB | Full Stack Academy</title>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #04AA6D;
            --bg-light: #f4f6f8;
            --border: #d1d5db;
        }

        body { font-family: 'Segoe UI', system-ui, sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; background: var(--bg-light); }

        /* Left: Course Navigation */
        .syllabus {
            width: 280px;
            background: white;
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
        }

        .syllabus-header { padding: 20px; background: var(--primary); color: white; font-weight: bold; }
        
        .course-folder { padding: 15px; background: #eee; font-size: 0.8rem; font-weight: bold; color: #666; text-transform: uppercase; }

        .lesson-link {
            padding: 12px 20px;
            cursor: pointer;
            font-size: 0.95rem;
            border-bottom: 1px solid #f0f0f0;
            transition: 0.2s;
        }

        .lesson-link:hover { background: #e8f5e9; }
        .lesson-link.active { border-left: 5px solid var(--accent); background: #f9fff9; font-weight: bold; }

        /* Middle: Tutorial Content */
        .tutorial-pane {
            flex: 1.2;
            padding: 30px;
            overflow-y: auto;
            background: white;
            line-height: 1.6;
        }

        /* Right: The Compiler */
        .compiler-pane {
            flex: 1.5;
            display: flex;
            flex-direction: column;
            background: #1e1e1e;
            color: white;
        }

        .compiler-header {
            padding: 10px;
            background: #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #editor {
            flex: 2;
            background: #1e1e1e;
            color: #d4d4d4;
            font-family: 'Consolas', monospace;
            padding: 20px;
            font-size: 14px;
            border: none;
            outline: none;
            resize: none;
        }

        .output-box {
            flex: 1;
            background: #000;
            border-top: 2px solid #444;
            padding: 15px;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            color: #00ff00;
            overflow-y: auto;
        }

        iframe { width: 100%; height: 100%; background: white; border: none; }

        /* Buttons */
        .btn-run { background: var(--accent); color: white; border: none; padding: 8px 20px; border-radius: 4px; cursor: pointer; font-weight: bold; }
        .btn-run:hover { background: #059862; }

        .progress-bar { height: 5px; background: #ddd; width: 100%; }
        #progress-fill { height: 100%; background: var(--accent); width: 0%; transition: 0.5s; }
        
        h1, h2 { color: var(--primary); }
        code { background: #eee; padding: 2px 5px; border-radius: 3px; font-family: monospace; }
    </style>
</head>
<body>

    <div class="syllabus">
        <div class="syllabus-header">BRU WEB ACADEMY</div>
        <div class="progress-bar"><div id="progress-fill"></div></div>
        
        <div class="course-folder">Module 1: Web Foundation</div>
        <div class="lesson-link active" onclick="loadPage('h1')">1.1 Introduction to HTML</div>
        <div class="lesson-link" onclick="loadPage('h2')">1.2 Styling with CSS</div>
        
        <div class="course-folder">Module 2: Logic & Data</div>
        <div class="lesson-link" onclick="loadPage('p1')">2.1 Python Variables</div>
        <div class="lesson-link" onclick="loadPage('p2')">2.2 Python Loops</div>
        
        <div class="course-folder">Module 3: Systems</div>
        <div class="lesson-link" onclick="loadPage('c1')">3.1 C++ Syntax</div>
    </div>

    <div class="tutorial-pane" id="lesson-ui">
        </div>

    <div class="compiler-pane">
        <div class="compiler-header">
            <span>Interactive Compiler</span>
            <button class="btn-run" onclick="execute()">Run Code &rsaquo;</button>
        </div>
        <textarea id="editor" spellcheck="false"></textarea>
        <div class="output-box" id="output-console">
            <iframe id="html-preview" style="display:none;"></iframe>
            <div id="text-output">Console ready...</div>
        </div>
    </div>

    <script>
        let pyodide;
        const lessons = {
            'h1': {
                type: 'html',
                title: 'Introduction to HTML',
                text: '<h1>HTML Basics</h1><p>HTML is the skeleton of the web. It uses "Tags" to tell the browser what to show.</p><h3>Task:</h3><p>Try changing the <code>&lt;h1&gt;</code> text to your name!</p>',
                code: '<html>\n<body>\n  <h1>Welcome to My Website</h1>\n  <p>Learning at BRU WEB is fun.</p>\n</body>\n</html>'
            },
            'p1': {
                type: 'python',
                title: 'Python Variables',
                text: '<h1>Python Variables</h1><p>In Python, we store data in variables. Unlike C++, you don\'t need to define the type.</p><h3>Task:</h3><p>Change the <code>age</code> variable and run the code.</p>',
                code: 'name = "User"\nage = 25\nprint(f"Hello {name}, you are {age} years old.")'
            },
            'c1': {
                type: 'cpp',
                title: 'C++ Basics',
                text: '<h1>C++ Structure</h1><p>C++ is a compiled language. Every program starts with a <code>main()</code> function.</p>',
                code: '#include <iostream>\nusing namespace std;\n\nint main() {\n    cout << "C++ logic in the browser!" << endl;\n    return 0;\n}'
            }
        };

        let currentId = 'h1';

        async function loadPage(id) {
            currentId = id;
            const lesson = lessons[id];
            
            // Update UI
            document.querySelectorAll('.lesson-link').forEach(el => el.classList.remove('active'));
            event?.target?.classList?.add('active');
            
            document.getElementById('lesson-ui').innerHTML = lesson.text;
            
            // Load code from LocalStorage or default
            const saved = localStorage.getItem('bru_' + id);
            document.getElementById('editor').value = saved || lesson.code;
            
            // Update Progress
            updateProgress();
            execute();
        }

        async function execute() {
            const code = document.getElementById('editor').value;
            const type = lessons[currentId].type;
            localStorage.setItem('bru_' + currentId, code); // Save progress

            const textOut = document.getElementById('text-output');
            const frame = document.getElementById('html-preview');

            if (type === 'html') {
                textOut.style.display = 'none';
                frame.style.display = 'block';
                const doc = frame.contentDocument;
                doc.open(); doc.write(code); doc.close();
            } else {
                frame.style.display = 'none';
                textOut.style.display = 'block';
                textOut.innerText = "Running...";

                if (type === 'python') {
                    if (!pyodide) pyodide = await loadPyodide();
                    try {
                        let output = await pyodide.runPython(`
                            import sys, io
                            sys.stdout = io.StringIO()
                            ${code}
                            sys.stdout.getvalue()
                        `);
                        textOut.innerText = output;
                    } catch(e) { textOut.innerText = e; }
                } else {
                    textOut.innerText = "Syntax Check Passed (Simulation Mode)\nOutput: " + (code.includes('cout') ? "Hello World" : "Compiled");
                }
            }
        }

        function updateProgress() {
            const total = Object.keys(lessons).length;
            const currentIdx = Object.keys(lessons).indexOf(currentId) + 1;
            document.getElementById('progress-fill').style.width = (currentIdx / total * 100) + '%';
        }

        window.onload = () => loadPage('h1');
    </script>
</body>
</html>
